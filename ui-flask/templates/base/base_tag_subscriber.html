{% extends "base/base.html" %}

{% block tag_runtime %}
<script src="/static/socket.io.min.js"></script>
<script src="/static/js/ui-widgets.js"></script>
<script>
console.log("=== base_tag_subscriber loaded ===");

(function () {
    const socket = io("/tags");

    
    window.TagRuntime = {
        socket: socket,
    };

    socket.on("connect", () => {
        console.log("[tags] connected");

        if (window.TAG_SUBSCRIPTIONS) {
            socket.emit("subscribe", {
                tags: window.TAG_SUBSCRIPTIONS
            });
        }
    });

    socket.on("tag_update", (tags) => {
        if (!tags || typeof tags !== "object") return;
        if (typeof window.onTagUpdate === "function") {
            window.onTagUpdate(tags);
        }
    });
})();
</script>

{% block tag_bindings %}{% endblock %}
{% endblock %}


