<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Poor-manView 1000</title>
    <meta name="viewport" content="width=800, height=480, user-scalable=no">

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
        }

        html, body {
            width: 800px;
            height: 480px;
            background-color: #e6e6e6;
            overflow: hidden;
        }

        #splash {
            position: absolute;
            width: 800px;
            height: 480px;
            background-color: #dcdcdc;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        #app {
            width: 800px;
            height: 480px;
            display: none;
            flex-direction: column;
        }

        .header {
            height: 40px;
            background: linear-gradient(#1f4fa3, #163b7a);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 16px;
            border-bottom: 3px solid #999;
        }

        .header svg {
            height: 36px;
        }

        .header-title {
            margin-left: auto;
            font-weight: bold;
            font-size: 20px;
        }

        .content {
            flex: 1;
            padding: 16px;
            background-color: #f2f2f2;
        }

        .card {
            background-color: white;
            border: 2px solid #999;
            padding: 12px;
            margin-bottom: 12px;
        }

        .card h2 {
            font-size: 18px;
            margin-bottom: 8px;
            border-bottom: 1px solid #ccc;
        }

        .footer {
            height: 30px;
            background-color: #c0c0c0;
            font-size: 12px;
            display: flex;
            align-items: center;
            padding: 0 10px;
            border-top: 2px solid #999;
        }
    </style>

    <!-- Splash clears independently of comms -->
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
            const splash = document.getElementById("splash");
            const app = document.getElementById("app");
            if (splash) splash.style.display = "none";
            if (app) app.style.display = "flex";
        }, 1500);
    });
    </script>
</head>

<body>

<div id="splash">
    <svg width="500" height="100" viewBox="0 0 500 100">
        <rect x="0" y="10" width="500" height="60" rx="8" fill="#1f4fa3"/>
        <text x="20" y="52" fill="white" font-size="28" font-weight="bold">
            Poor-manView
        </text>
        <text x="360" y="52" fill="white" font-size="22" font-weight="bold">
            1000
        </text>
    </svg>
</div>

<div id="app">
    <div class="header">
        <svg width="120" height="36" viewBox="0 0 120 36">
            <rect x="0" y="4" width="120" height="28" rx="4" fill="white"/>
            <text x="8" y="25" fill="#1f4fa3" font-size="16" font-weight="bold">
                PMV
            </text>
        </svg>
        <div class="header-title">Poor-manView 1000</div>
    </div>

    <div class="content">
        <div class="card">
            <h2>System Status</h2>
            <p>Runtime: OK</p>
            <p>Shared Memory: OK</p>
            <p>UI: Connected</p>
        </div>

        <div class="card">
            <h2>Fake Smoker Data</h2>
            <p>Meat Temp: 95.4 Â°F</p>
            <p>Smoker Temp: 123.5 Â°F</p>
            <p>Heater 1: 75%</p>
            <p>Heater 2: 22%</p>
        </div>
    </div>

    <a href="/maintenance">
        <button style="font-size:16px;">âš™ Settings</button>
    </a>

    <span id="time">--:--:--.---</span>

    <div class="footer">
        Poor-manView 1000 &nbsp;|&nbsp; Not Rockwell Automation ðŸ˜„
    </div>
</div>

<!-- Pattern C: synchronous, deterministic -->
<script src="/static/socket.io.min.js"></script>
<script>
    if (typeof io === "undefined") {
        console.warn("Socket.IO not available");
    } else {
        const socket = io({
            reconnection: true,
            reconnectionDelay: 1000,
            reconnectionAttempts: Infinity
        });

        socket.on("connect", () => {
            console.log("Socket.IO connected");
        });

        socket.on("time_update", (data) => {
            const t = document.getElementById("time");
            if (t) t.textContent = data.time;
        });

        socket.on("disconnect", () => {
            console.warn("Socket.IO disconnected");
        });
    }
</script>

</body>
</html>
